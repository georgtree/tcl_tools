<!DOCTYPE html><html><head><meta charset="utf-8"/>
<title>Collection of Tcl tools</title>
<link rel='stylesheet' type='text/css' href='assets/ruff-min.css' />
<script type='text/javascript' src='assets/ruff-min.js'></script>
</head>
<body>
<div class='ruff-layout'>
<header class='ruff-layout-header ruff-hd'>
<a style='text-decoration:none;' href='index.html'>Collection of Tcl tools (v0.1)</a>


            <div id="ruffButtonBar">
            <button id="ruffNavMove" onclick="ruffMoveNavPane()"></button>
            <button id="ruffToggleTheme" onclick="ruffNextTheme()"></button>
            </div>
        </header><main class='ruff-layout-main ruff-bd'><h1 class='ruff'><a name='::rfutil'></a>::rfutil<span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h1>
<div style='clear:both;'></div>
<h2 class='ruff'><a name='::rfutil-Commands'></a>Commands<span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h2>
<div style='clear:both;'></div>
<h3 class='ruffproc'><a name='::rfutil::angle'>angle</a><span class='ns_scope'> [<a href="index-rfutil.html#::rfutil" title="::rfutil" class='ruff_cmd'>::rfutil</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Calculates angle (phase) of complex number.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>angle</span> <span class='ruff_arg'>data ?args?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>data</code></td><td>List with complex data in form a+i*b.</td></tr>
<tr><td><code>-deg</code></td><td>Option to select angle in degrees units.</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns list of angles</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_rfutil_angle' href="javascript:toggleSource('rfutil_angle')">Show source</a></p>
<div id='rfutil_angle' class='ruff_dyn_src'><pre>proc ::rfutil::angle {data args} {

    # Calculates angle (phase) of complex number.
    #
    #  data - List with complex data in form a+i*b
    #  -deg - Option to select angle in degrees units
    #
    # Returns list of angles
    #
    set arguments [argparse -inline {
        {-deg -boolean} }]
    variable radtodeg
    set len [llength $data]
    if {[dget $arguments deg]==1} {
        for {set i 0} {$i&lt;$len} {incr i} {
            lappend result [= {$radtodeg*[arg [@ $data $i]]}]
        }
    } else {
        for {set i 0} {$i&lt;$len} {incr i} {
            lappend result [arg [@ $data $i]]
        }
    }
    return $result
}</pre></div>
</div><h3 class='ruffproc'><a name='::rfutil::compLen'>compLen</a><span class='ns_scope'> [<a href="index-rfutil.html#::rfutil" title="::rfutil" class='ruff_cmd'>::rfutil</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Check the lengths of lists of each dictionary's list</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>compLen</span> <span class='ruff_arg'>dict</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>dict</code></td><td>Input dictionary.</td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_rfutil_compLen' href="javascript:toggleSource('rfutil_compLen')">Show source</a></p>
<div id='rfutil_compLen' class='ruff_dyn_src'><pre>proc ::rfutil::compLen {dict} {

    # Check the lengths of lists of each dictionary's list
    #  dict - input dictionary
    set keys [dkeys $dict]
    set values [dvalues $dict]
    set size [dsize $dict]
    for {set i 0} {$i&lt;[= {$size-1}]} {incr i} {
        set keyA [@ $keys $i]
        set keyB [@ $keys [= {$i+1}]]
        set lenA [llength [@ $values $i]]
        set lenB [llength [@ $values [= {$i+1}]]]
        if {$lenA!=$lenB} {
            error &quot;Length of $keyA '$lenA' is not equal to length of $keyB '$lenB'&quot;
        }
    }
    return
}</pre></div>
</div><h3 class='ruffproc'><a name='::rfutil::cxxPEq'>cxxPEq</a><span class='ns_scope'> [<a href="index-rfutil.html#::rfutil" title="::rfutil" class='ruff_cmd'>::rfutil</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Calculates capacitive part equivalent P circuit elements values.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>cxxPEq</span> <span class='ruff_arg'>freq yxx</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>freq</code></td><td>Frequency values list.</td></tr>
<tr><td><code>yxx</code></td><td>Dictionary that contains 2-port matrix of y-parameters, each matrix element is the list of values at different frequencies (or other parameter) in form of {real imag}. The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}</td></tr>
</table>
<h5 class='ruff'>Description</h5><pre class='ruff'>
                C3
                 | |
     o-----o-----| |-----o-----o
     .     |     | |     |     .
     .     |             |     .
  P1 .  C1---         C2---    . P2
     .    ---           ---    .
    \./    |             |    \./
     .     |             |     .
     o-----o-------------o-----o
</pre>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns dictionary of the form {c1 {list} c2 {list} c3 {list}} with capacitive part of equivalent elements admittance</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_rfutil_cxxPEq' href="javascript:toggleSource('rfutil_cxxPEq')">Show source</a></p>
<div id='rfutil_cxxPEq' class='ruff_dyn_src'><pre>proc ::rfutil::cxxPEq {freq yxx} {

    # Calculates capacitive part equivalent P circuit elements values.
    #
    #  freq - Frequency values list
    #  yxx - Dictionary that contains 2-port matrix of y-parameters,
    #   each matrix element is the list of values at different
    #   frequencies (or other parameter) in form of {real imag}.
    #   The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}
    #
    # Returns dictionary of the form {c1 {list} c2 {list} c3 {list}} with capacitive part of equivalent elements
    # admittance
    #
    #                     C3
    #                      | |
    #          o-----o-----| |-----o-----o
    #          .     |     | |     |     .
    #          .     |             |     .
    #       P1 .  C1---         C2---    . P2
    #          .    ---           ---    .
    #         \./    |             |    \./
    #          .     |             |     .
    #          o-----o-------------o-----o
    #
    ::rfutil::compLen [dict merge [dict create freq $freq] $yxx]
    variable pi
    set yEq [::rfutil::yPEq $yxx]
    set len [llength $freq]
    for {set i 0} {$i&lt;$len} {incr i} {
        set freqVal [@ $freq $i]
        set y1 [@ [dget $yEq y1] $i]
        set y2 [@ [dget $yEq y2] $i]
        set y3 [@ [dget $yEq y3] $i]
        lappend c1 [= {[imag $y1]/(2*$pi*$freqVal)}]
        lappend c2 [= {[imag $y2]/(2*$pi*$freqVal)}]
        lappend c3 [= {[imag $y3]/(2*$pi*$freqVal)}]
    }
    return [dict create c1 $c1 c2 $c2 c3 $c3]
}</pre></div>
</div><h3 class='ruffproc'><a name='::rfutil::cxxTEq'>cxxTEq</a><span class='ns_scope'> [<a href="index-rfutil.html#::rfutil" title="::rfutil" class='ruff_cmd'>::rfutil</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Calculates capacitive part equivalent T circuit elements values.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>cxxTEq</span> <span class='ruff_arg'>freq zxx</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>freq</code></td><td>Frequency values list.</td></tr>
<tr><td><code>zxx</code></td><td>Dictionary that contains 2-port matrix of z-parameters, each matrix element is the list of values at different frequencies (or other parameter) in form of {real imag}. The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}</td></tr>
</table>
<h5 class='ruff'>Description</h5><pre class='ruff'>
        C1           C2
         | |           | |
    o----| |-----o-----| |----o
    .    | |     |     | |    .
    .            |            .
 P1 .         C3---           . P2
    .           ---           .
   \./           |           \./
    .            |            .
    o----------- o -----------o
</pre>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns dictionary of the form {c1 {list} c2 {list} c3 {list}} with capacitive part of equivalent elements impedance</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_rfutil_cxxTEq' href="javascript:toggleSource('rfutil_cxxTEq')">Show source</a></p>
<div id='rfutil_cxxTEq' class='ruff_dyn_src'><pre>proc ::rfutil::cxxTEq {freq zxx} {

    # Calculates capacitive part equivalent T circuit elements values.
    #
    #  freq - Frequency values list
    #  zxx - Dictionary that contains 2-port matrix of z-parameters,
    #   each matrix element is the list of values at different
    #   frequencies (or other parameter) in form of {real imag}.
    #   The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}
    #
    # Returns dictionary of the form {c1 {list} c2 {list} c3 {list}} with capacitive part of equivalent elements
    # impedance
    #
    #             C1           C2
    #              | |           | |
    #         o----| |-----o-----| |----o
    #         .    | |     |     | |    .
    #         .            |            .
    #      P1 .         C3---           . P2
    #         .           ---           .
    #        \./           |           \./
    #         .            |            .
    #         o----------- o -----------o
    #
    ::rfutil::compLen [dict merge [dict create freq $freq] $zxx]
    variable pi
    set zEq [::rfutil::zTEq $zxx]
    set 1c [complex 1 0]
    set len [llength $freq]
    for {set i 0} {$i&lt;$len} {incr i} {
        set freqVal [@ $freq $i]
        set z1 [@ [dget $zEq z1] $i]
        set z2 [@ [dget $zEq z2] $i]
        set z3 [@ [dget $zEq z3] $i]
        lappend c1 [= {-1/(2*$pi*$freqVal*[imag $z1])}]
        lappend c2 [= {-1/(2*$pi*$freqVal*[imag $z2])}]
        lappend c3 [= {-1/(2*$pi*$freqVal*[imag $z3])}]
    }
    return [dict create c1 $c1 c2 $c2 c3 $c3]
}</pre></div>
</div><h3 class='ruffproc'><a name='::rfutil::deemb'>deemb</a><span class='ns_scope'> [<a href="index-rfutil.html#::rfutil" title="::rfutil" class='ruff_cmd'>::rfutil</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Procedure for deembedding of DUT from test fixture.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>deemb</span> <span class='ruff_arg'>sMeas sFixtL sFixtR</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>sMeas</code></td><td>Measured s-parameters matrix in dictionary form {11 {list} 12 {list} 21 {list} 22 {list}}</td></tr>
<tr><td><code>sFixtL</code></td><td>S-parameters matrix of left fixture in dictionary form {11 {list} 12 {list} 21 {list} 22 {list}}</td></tr>
<tr><td><code>sFixtR</code></td><td>S-parameters matrix of right fixture in dictionary form {11 {list} 12 {list} 21 {list} 22 {list}}</td></tr>
</table>
<h5 class='ruff'>Description</h5>
<figure  class='ruff-snippet ruff-figure'><pre class='ruff'>
   ┌      ┐   ┌        ┐-1   ┌       ┐     ┌        ┐-1
   │ Tdut │ = │ Tfixtl │  x  │ Tmeas │  x  │ Tfixtr │
   └      ┘   └        ┘     └       ┘     └        ┘
</pre>

</figure><h5 class='ruff'>Return value</h5><p class='ruff'>Returns dictionary of the same form as input dictionaries with deembedded DUT s-matrix</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_rfutil_deemb' href="javascript:toggleSource('rfutil_deemb')">Show source</a></p>
<div id='rfutil_deemb' class='ruff_dyn_src'><pre>proc ::rfutil::deemb {sMeas sFixtL sFixtR} {

    # Procedure for deembedding of DUT from test fixture.
    #
    #  sMeas - Measured s-parameters matrix in dictionary form {11 {list} 12 {list} 21 {list} 22 {list}}
    #  sFixtL - s-parameters matrix of left fixture in dictionary form {11 {list} 12 {list} 21 {list} 22 {list}}
    #  sFixtR - s-parameters matrix of right fixture in dictionary form {11 {list} 12 {list} 21 {list} 22 {list}}
    #
    # Returns dictionary of the same form as input dictionaries with deembedded DUT s-matrix
    #```
    #    ┌      ┐   ┌        ┐-1   ┌       ┐     ┌        ┐-1
    #    │ Tdut │ = │ Tfixtl │  x  │ Tmeas │  x  │ Tfixtr │
    #    └      ┘   └        ┘     └       ┘     └        ┘
    #```
    ::rfutil::compLen [dict merge $sMeas $sFixtL $sFixtR]
    set tMeas [s2t $sMeas]
    set tFixtL [inv2x2 [s2t $sFixtL]]
    set tFixtR [inv2x2 [s2t $sFixtR]]
    set tDut [matMul2x2 [matMul2x2 $tFixtL $tMeas] $tFixtR]
    set sDut [t2s $tDut]
    return $sDut
}</pre></div>
</div><h3 class='ruffproc'><a name='::rfutil::inv2x2'>inv2x2</a><span class='ns_scope'> [<a href="index-rfutil.html#::rfutil" title="::rfutil" class='ruff_cmd'>::rfutil</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Calculates inverse matrix of input matrix with size 2x2.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>inv2x2</span> <span class='ruff_arg'>mat</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>mat</code></td><td>Dictionary that contains 2-port matrix, each matrix element is the list of values at different frequencies (or other parameter) in form of {real imag}. The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns dictionary of the same form as input dictionary with resulted matrix</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_rfutil_inv2x2' href="javascript:toggleSource('rfutil_inv2x2')">Show source</a></p>
<div id='rfutil_inv2x2' class='ruff_dyn_src'><pre>proc ::rfutil::inv2x2 {mat} {

    # Calculates inverse matrix of input matrix with size 2x2.
    #
    #  mat - Dictionary that contains 2-port matrix,
    #   each matrix element is the list of values at different
    #   frequencies (or other parameter) in form of {real imag}.
    #   The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}
    #
    # Returns dictionary of the same form as input dictionary with resulted matrix
    #
    ::rfutil::compLen $mat
    set len [llength [dget $mat 11]]
    set 1c [complex 1 0]
    set m1c [complex -1 0]
    for {set i 0} {$i&lt;$len} {incr i} {
        set a [@ [dget $mat 11] $i]
        set b [@ [dget $mat 12] $i]
        set c [@ [dget $mat 21] $i]
        set d [@ [dget $mat 22] $i]
        set det [- [* $a $d] [* $b $c]]
        if {([real $det]==0.0) &amp;&amp; ([imag $det]==0.0)} {
            error &quot;Matrix can't be inverted&quot;
        }
        set rec [/ $1c $det]
        lappend 11 [* $rec $d]
        lappend 12 [* $rec [* $m1c $b]]
        lappend 21 [* $rec [* $m1c $c]]
        lappend 22 [* $rec $a]
    }
    return [dict create 11 $11 21 $21 12 $12 22 $22]
}</pre></div>
</div><h3 class='ruffproc'><a name='::rfutil::lxxPEq'>lxxPEq</a><span class='ns_scope'> [<a href="index-rfutil.html#::rfutil" title="::rfutil" class='ruff_cmd'>::rfutil</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Calculates inductive part equivalent P circuit elements values.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>lxxPEq</span> <span class='ruff_arg'>freq yxx</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>freq</code></td><td>Frequency values list.</td></tr>
<tr><td><code>yxx</code></td><td>Dictionary that contains 2-port matrix of y-parameters, each matrix element is the list of values at different frequencies (or other parameter) in form of {real imag}. The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}</td></tr>
</table>
<h5 class='ruff'>Description</h5><pre class='ruff'>
                  L3
                  ___
      o-----o-----UUU-----o-----o
      .     |             |     .
      .  L1 C|         L2 C|    .
   P1 .     C|            C|    . P2
      .     C|            C|    .
     \./    |             |    \./
      .     |             |     .
      o-----o-------------o-----o
</pre>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns dictionary of the form {l1 {list} l2 {list} l3 {list}} with inductive part of equivalent elements impedance</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_rfutil_lxxPEq' href="javascript:toggleSource('rfutil_lxxPEq')">Show source</a></p>
<div id='rfutil_lxxPEq' class='ruff_dyn_src'><pre>proc ::rfutil::lxxPEq {freq yxx} {

    # Calculates inductive part equivalent P circuit elements values.
    #
    #  freq - Frequency values list
    #  yxx - Dictionary that contains 2-port matrix of y-parameters,
    #   each matrix element is the list of values at different
    #   frequencies (or other parameter) in form of {real imag}.
    #   The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}
    #
    # Returns dictionary of the form {l1 {list} l2 {list} l3 {list}} with inductive part of equivalent elements
    # impedance
    #
    #                       L3
    #                       ___
    #           o-----o-----UUU-----o-----o
    #           .     |             |     .
    #           .  L1 C|         L2 C|    .
    #        P1 .     C|            C|    . P2
    #           .     C|            C|    .
    #          \./    |             |    \./
    #           .     |             |     .
    #           o-----o-------------o-----o
    #
    ::rfutil::compLen [dict merge [dict create freq $freq] $yxx]
    variable pi
    set yEq [::rfutil::yPEq $yxx]
    set len [llength $freq]
    for {set i 0} {$i&lt;$len} {incr i} {
        set freqVal [@ $freq $i]
        set y1 [@ [dget $yEq y1] $i]
        set y2 [@ [dget $yEq y2] $i]
        set y3 [@ [dget $yEq y3] $i]
        lappend l1 [= {-1/(2*$pi*$freqVal*[imag $y1])}]
        lappend l2 [= {-1/(2*$pi*$freqVal*[imag $y2])}]
        lappend l3 [= {-1/(2*$pi*$freqVal*[imag $y3])}]
    }
    return [dict create l1 $l1 l2 $l2 l3 $l3]
}</pre></div>
</div><h3 class='ruffproc'><a name='::rfutil::lxxTEq'>lxxTEq</a><span class='ns_scope'> [<a href="index-rfutil.html#::rfutil" title="::rfutil" class='ruff_cmd'>::rfutil</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Calculates inductive part equivalent T circuit elements values.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>lxxTEq</span> <span class='ruff_arg'>freq zxx</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>freq</code></td><td>Frequency values list.</td></tr>
<tr><td><code>zxx</code></td><td>Dictionary that contains 2-port matrix of z-parameters, each matrix element is the list of values at different frequencies (or other parameter) in form of {real imag}. The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}</td></tr>
</table>
<h5 class='ruff'>Description</h5><pre class='ruff'>
        L1            L2
         ___           ___
    o----UUU-----o-----UUU----o
    .            |            .
    .         L3 C|           .
 P1 .            C|           . P2
    .            C|           .
   \./           |           \./
    .            |            .
    o----------- o -----------o
</pre>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns dictionary of the form {l1 {list} l2 {list} l3 {list}} with inductive part of equivalent elements impedance</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_rfutil_lxxTEq' href="javascript:toggleSource('rfutil_lxxTEq')">Show source</a></p>
<div id='rfutil_lxxTEq' class='ruff_dyn_src'><pre>proc ::rfutil::lxxTEq {freq zxx} {

    # Calculates inductive part equivalent T circuit elements values.
    #
    #  freq - Frequency values list
    #  zxx - Dictionary that contains 2-port matrix of z-parameters,
    #   each matrix element is the list of values at different
    #   frequencies (or other parameter) in form of {real imag}.
    #   The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}
    #
    # Returns dictionary of the form {l1 {list} l2 {list} l3 {list}} with inductive part of equivalent elements
    # impedance
    #
    #             L1            L2
    #              ___           ___
    #         o----UUU-----o-----UUU----o
    #         .            |            .
    #         .         L3 C|           .
    #      P1 .            C|           . P2
    #         .            C|           .
    #        \./           |           \./
    #         .            |            .
    #         o----------- o -----------o
    #
    ::rfutil::compLen [dict merge [dict create freq $freq] $zxx]
    variable pi
    set zEq [::rfutil::zTEq $zxx]
    set len [llength $freq]
    for {set i 0} {$i&lt;$len} {incr i} {
        set freqVal [@ $freq $i]
        set z1 [@ [dget $zEq z1] $i]
        set z2 [@ [dget $zEq z2] $i]
        set z3 [@ [dget $zEq z3] $i]
        lappend l1 [= {[imag $z1]/(2*$pi*$freqVal)}]
        lappend l2 [= {[imag $z2]/(2*$pi*$freqVal)}]
        lappend l3 [= {[imag $z3]/(2*$pi*$freqVal)}]
    }
    return [dict create l1 $l1 l2 $l2 l3 $l3]
}</pre></div>
</div><h3 class='ruffproc'><a name='::rfutil::mag'>mag</a><span class='ns_scope'> [<a href="index-rfutil.html#::rfutil" title="::rfutil" class='ruff_cmd'>::rfutil</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Calculates magnitude of complex number.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>mag</span> <span class='ruff_arg'>data ?args?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>data</code></td><td>List with complex data in form a+i*b.</td></tr>
<tr><td><code>-db</code></td><td>Option to select magnitude in db scale.</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns list of magnitudes</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_rfutil_mag' href="javascript:toggleSource('rfutil_mag')">Show source</a></p>
<div id='rfutil_mag' class='ruff_dyn_src'><pre>proc ::rfutil::mag {data args} {

    # Calculates magnitude of complex number.
    #
    #  data - List with complex data in form a+i*b
    #  -db - Option to select magnitude in db scale
    #
    # Returns list of magnitudes
    #
    set arguments [argparse -inline {
        {-db -boolean} }]
    set len [llength $data]
    if {[dget $arguments db]==1} {
        for {set i 0} {$i&lt;$len} {incr i} {
            lappend result [= {20*log10([mod [@ $data $i]])}]
        }
    } else {
        for {set i 0} {$i&lt;$len} {incr i} {
            lappend result [mod [@ $data $i]]
        }
    }
    return $result
}</pre></div>
</div><h3 class='ruffproc'><a name='::rfutil::matMul2x2'>matMul2x2</a><span class='ns_scope'> [<a href="index-rfutil.html#::rfutil" title="::rfutil" class='ruff_cmd'>::rfutil</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Calculates multiply matrices with 2x2 size.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>matMul2x2</span> <span class='ruff_arg'>mat1 mat2</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>mat1</code></td><td>First matrix in dictionary form {11 {list} 12 {list} 21 {list} 22 {list}}</td></tr>
<tr><td><code>mat2</code></td><td>Second matrix in dictionary form {11 {list} 12 {list} 21 {list} 22 {list}}</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns dictionary of the same form as input dictionaries with resulted matrix</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_rfutil_matMul2x2' href="javascript:toggleSource('rfutil_matMul2x2')">Show source</a></p>
<div id='rfutil_matMul2x2' class='ruff_dyn_src'><pre>proc ::rfutil::matMul2x2 {mat1 mat2} {

    # Calculates multiply matrices with 2x2 size.
    #
    #  mat1 - First matrix in dictionary form {11 {list} 12 {list} 21 {list} 22 {list}}
    #  mat2 - Second matrix in dictionary form {11 {list} 12 {list} 21 {list} 22 {list}}
    #
    # Returns dictionary of the same form as input dictionaries with resulted matrix
    #
    ::rfutil::compLen [dict merge $mat1 $mat2]
    set len1 [llength [dget $mat1 11]]
    ::rfutil::compLen $mat1
    ::rfutil::compLen $mat2
    for {set i 0} {$i&lt;$len1} {incr i} {
        set a1 [@ [dget $mat1 11] $i]
        set b1 [@ [dget $mat1 12] $i]
        set c1 [@ [dget $mat1 21] $i]
        set d1 [@ [dget $mat1 22] $i]
        set a2 [@ [dget $mat2 11] $i]
        set b2 [@ [dget $mat2 12] $i]
        set c2 [@ [dget $mat2 21] $i]
        set d2 [@ [dget $mat2 22] $i]
        lappend 11 [+ [* $a1 $a2] [* $b1 $c2]]
        lappend 12 [+ [* $a1 $b2] [* $b1 $d2]]
        lappend 21 [+ [* $c1 $a2] [* $d1 $c2]]
        lappend 22 [+ [* $c1 $b2] [* $d1 $d2]]
    }
    return [dict create 11 $11 21 $21 12 $12 22 $22]
}</pre></div>
</div><h3 class='ruffproc'><a name='::rfutil::s2t'>s2t</a><span class='ns_scope'> [<a href="index-rfutil.html#::rfutil" title="::rfutil" class='ruff_cmd'>::rfutil</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Converts 2-port s-parameters to transfer parameters.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>s2t</span> <span class='ruff_arg'>sxx</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>sxx</code></td><td>Dictionary that contains 2-port matrix of s-parameters, each matrix element is the list of values at different frequencies (or other parameter) in form of {real imag}. The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns dictionary of the same form as input dictionary with transfer parameters</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_rfutil_s2t' href="javascript:toggleSource('rfutil_s2t')">Show source</a></p>
<div id='rfutil_s2t' class='ruff_dyn_src'><pre>proc ::rfutil::s2t {sxx} {

    # Converts 2-port s-parameters to transfer parameters.
    #
    #  sxx - Dictionary that contains 2-port matrix of s-parameters,
    #   each matrix element is the list of values at different
    #   frequencies (or other parameter) in form of {real imag}.
    #   The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}
    #
    # Returns dictionary of the same form as input dictionary with transfer parameters
    #
    ::rfutil::compLen $sxx
    set len [llength [dget $sxx 11]]
    set 1c [complex 1 0]
    set m1c [complex -1 0]
    for {set i 0} {$i&lt;$len} {incr i} {
        set 11 [@ [dget $sxx 11] $i]
        set 21 [@ [dget $sxx 21] $i]
        set 12 [@ [dget $sxx 12] $i]
        set 22 [@ [dget $sxx 22] $i]
        lappend t11 [- $12 [/ [* $11 $22] $21]]
        lappend t12 [/ $11 $21]
        lappend t21 [* $m1c [/ $22 $21]]
        lappend t22 [/ $1c $21]
    }
    return [dict create 11 $t11 21 $t21 12 $t12 22 $t22]
}</pre></div>
</div><h3 class='ruffproc'><a name='::rfutil::s2y'>s2y</a><span class='ns_scope'> [<a href="index-rfutil.html#::rfutil" title="::rfutil" class='ruff_cmd'>::rfutil</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Converts 2-port s-parameters to y-parameters.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>s2y</span> <span class='ruff_arg'>sxx z0</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>sxx</code></td><td>Dictionary that contains 2-port matrix of s-parameters, each matrix element is the list of values at different frequencies (or other parameter) in form of {real imag}. The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}</td></tr>
<tr><td><code>z0</code></td><td>Reference impedance in form of {real imag}</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns dictionary of the same form as input dictionary with y-parameters</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_rfutil_s2y' href="javascript:toggleSource('rfutil_s2y')">Show source</a></p>
<div id='rfutil_s2y' class='ruff_dyn_src'><pre>proc ::rfutil::s2y {sxx z0} {

    # Converts 2-port s-parameters to y-parameters.
    #
    #  sxx - Dictionary that contains 2-port matrix of s-parameters,
    #   each matrix element is the list of values at different
    #   frequencies (or other parameter) in form of {real imag}.
    #   The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}
    #  z0 - Reference impedance in form of {real imag}
    #
    # Returns dictionary of the same form as input dictionary with y-parameters
    #
    ::rfutil::compLen $sxx
    set len [llength [dget $sxx 11]]
    set 1c [complex 1 0]
    set 2c [complex 2 0]
    set m2c [complex -2 0]
    set y0 [pow $z0 [complex -1 0]]
    for {set i 0} {$i&lt;$len} {incr i} {
        set 11 [@ [dget $sxx 11] $i]
        set 21 [@ [dget $sxx 21] $i]
        set 12 [@ [dget $sxx 12] $i]
        set 22 [@ [dget $sxx 22] $i]
        lappend y11 [* $y0 [/ [+ [* [- $1c $11] [+ $1c $22]] [* $12 $21]] [- [* [+ $1c $11] [+ $1c $22]] [* $12 $21]]]]
        lappend y12 [* $y0 [/ [* $m2c $12] [- [* [+ $1c $11] [+ $1c $22]] [* $12 $21] ]]]
        lappend y21 [* $y0 [/ [* $m2c $21] [- [* [+ $1c $11] [+ $1c $22]] [* $12 $21] ]]]
        lappend y22 [* $y0 [/ [+ [* [+ $1c $11] [- $1c $22]] [* $12 $21]] [- [* [+ $1c $11] [+ $1c $22]] [* $12 $21]]]]
    }
    return  [dict create 11 $y11 21 $y21 12 $y12 22 $y22]
}</pre></div>
</div><h3 class='ruffproc'><a name='::rfutil::s2z'>s2z</a><span class='ns_scope'> [<a href="index-rfutil.html#::rfutil" title="::rfutil" class='ruff_cmd'>::rfutil</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Converts 2-port s-parameters to z-parameters.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>s2z</span> <span class='ruff_arg'>sxx z0</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>sxx</code></td><td>Dictionary that contains 2-port matrix of s-parameters, each matrix element is the list of values at different frequencies (or other parameter) in form of {real imag}. The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}</td></tr>
<tr><td><code>z0</code></td><td>Reference impedance in form of {real imag}</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns dictionary of the same form as input dictionary with z-parameters</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_rfutil_s2z' href="javascript:toggleSource('rfutil_s2z')">Show source</a></p>
<div id='rfutil_s2z' class='ruff_dyn_src'><pre>proc ::rfutil::s2z {sxx z0} {

    # Converts 2-port s-parameters to z-parameters.
    #
    #  sxx - Dictionary that contains 2-port matrix of s-parameters,
    #   each matrix element is the list of values at different
    #   frequencies (or other parameter) in form of {real imag}.
    #   The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}
    #  z0 - Reference impedance in form of {real imag}
    #
    # Returns dictionary of the same form as input dictionary with z-parameters
    #
    ::rfutil::compLen $sxx
    set len [llength [dget $sxx 11]]
    set 1c [complex 1 0]
    set 2c [complex 2 0]
    for {set i 0} {$i&lt;$len} {incr i} {
        set 11 [@ [dget $sxx 11] $i]
        set 21 [@ [dget $sxx 21] $i]
        set 12 [@ [dget $sxx 12] $i]
        set 22 [@ [dget $sxx 22] $i]
        lappend z11 [* $z0 [/ [+ [* [+ $1c $11] [- $1c $22]] [* $12 $21]] [- [* [- $1c $11] [- $1c $22]] [* $12 $21]]]]
        lappend z12 [* $z0 [/ [* $2c $12] [- [* [- $1c $11] [- $1c $22]] [* $12 $21] ]]]
        lappend z21 [* $z0 [/ [* $2c $21] [- [* [- $1c $11] [- $1c $22]] [* $12 $21] ]]]
        lappend z22 [* $z0 [/ [+ [* [- $1c $11] [+ $1c $22]] [* $12 $21]] [- [* [- $1c $11] [- $1c $22]] [* $12 $21]]]]
    }
    return [dict create 11 $z11 21 $z21 12 $z12 22 $z22]
}</pre></div>
</div><h3 class='ruffproc'><a name='::rfutil::t2s'>t2s</a><span class='ns_scope'> [<a href="index-rfutil.html#::rfutil" title="::rfutil" class='ruff_cmd'>::rfutil</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Converts 2-port transfer parameters to s-parameters.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>t2s</span> <span class='ruff_arg'>txx</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>txx</code></td><td>Dictionary that contains 2-port matrix of transfer parameters, each matrix element is the list of values at different frequencies (or other parameter) in form of {real imag}. The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns dictionary of the same form as input dictionary with s-parameters</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_rfutil_t2s' href="javascript:toggleSource('rfutil_t2s')">Show source</a></p>
<div id='rfutil_t2s' class='ruff_dyn_src'><pre>proc ::rfutil::t2s {txx} {

    # Converts 2-port transfer parameters to s-parameters.
    #
    #  txx - Dictionary that contains 2-port matrix of transfer parameters,
    #   each matrix element is the list of values at different
    #   frequencies (or other parameter) in form of {real imag}.
    #   The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}
    # Returns dictionary of the same form as input dictionary with s-parameters
    #
    ::rfutil::compLen $txx
    set len [llength [dget $txx 11]]
    set 1c [complex 1 0]
    set m1c [complex -1 0]
    for {set i 0} {$i&lt;$len} {incr i} {
        set 11 [@ [dget $txx 11] $i]
        set 21 [@ [dget $txx 21] $i]
        set 12 [@ [dget $txx 12] $i]
        set 22 [@ [dget $txx 22] $i]
        lappend s11 [/ $12 $22]
        lappend s12 [- $11 [/ [* $12 $21] $22]]
        lappend s21 [/ $1c $22]
        lappend s22 [* $m1c [/ $21 $22]]
    }
    return [dict create 11 $s11 21 $s21 12 $s12 22 $s22]
}</pre></div>
</div><h3 class='ruffproc'><a name='::rfutil::y2s'>y2s</a><span class='ns_scope'> [<a href="index-rfutil.html#::rfutil" title="::rfutil" class='ruff_cmd'>::rfutil</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Converts 2-port y-parameters to s-parameters.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>y2s</span> <span class='ruff_arg'>yxx z0</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>yxx</code></td><td>Dictionary that contains 2-port matrix of y-parameters, each matrix element is the list of values at different frequencies (or other parameter) in form of {real imag}. The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}</td></tr>
<tr><td><code>z0</code></td><td>Reference impedance in form of {real imag}</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns dictionary of the same form as input dictionary with s-parameters</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_rfutil_y2s' href="javascript:toggleSource('rfutil_y2s')">Show source</a></p>
<div id='rfutil_y2s' class='ruff_dyn_src'><pre>proc ::rfutil::y2s {yxx z0} {

    # Converts 2-port y-parameters to s-parameters.
    #
    #   yxx - Dictionary that contains 2-port matrix of y-parameters,
    #    each matrix element is the list of values at different
    #    frequencies (or other parameter) in form of {real imag}.
    #    The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}
    #   z0 - Reference impedance in form of {real imag}
    #
    # Returns dictionary of the same form as input dictionary with s-parameters
    #
    ::rfutil::compLen $yxx
    set len [llength [dget $yxx 11]]
    set 1c [complex 1 0]
    set 2c [complex 2 0]
    set m2c [complex -2 0]
    set y0 [pow $z0 [complex -1 0]]
    for {set i 0} {$i&lt;$len} {incr i} {
        set 11 [@ [dget $yxx 11] $i]
        set 21 [@ [dget $yxx 21] $i]
        set 12 [@ [dget $yxx 12] $i]
        set 22 [@ [dget $yxx 22] $i]
        lappend s11 [/ [+ [* [- $y0 $11 ] [+ $y0 $22]] [* $12 $21]] [- [* [+ $y0 $11] [+ $y0 $22]] [* $12 $21]]]
        lappend s12 [/ [* [* $m2c $12] $y0] [- [* [+ $y0 $11] [+ $y0 $22]] [* $12 $21]]]
        lappend s21 [/ [* [* $m2c $21] $y0] [- [* [+ $y0 $11] [+ $y0 $22]] [* $12 $21]]]
        lappend s22 [/ [+ [* [+ $y0 $11 ] [- $y0 $22]] [* $12 $21]] [- [* [+ $y0 $11] [+ $y0 $22]] [* $12 $21]]]
    }
    return [dict create 11 $s11 21 $s21 12 $s12 22 $s22]
}</pre></div>
</div><h3 class='ruffproc'><a name='::rfutil::y2z'>y2z</a><span class='ns_scope'> [<a href="index-rfutil.html#::rfutil" title="::rfutil" class='ruff_cmd'>::rfutil</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Converts 2-port y-parameters to z-parameters.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>y2z</span> <span class='ruff_arg'>yxx</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>yxx</code></td><td>Dictionary that contains 2-port matrix of y-parameters, each matrix element is the list of values at different frequencies (or other parameter) in form of {real imag}. The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns dictionary of the same form as input dictionary with z-parameters</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_rfutil_y2z' href="javascript:toggleSource('rfutil_y2z')">Show source</a></p>
<div id='rfutil_y2z' class='ruff_dyn_src'><pre>proc ::rfutil::y2z {yxx} {

    # Converts 2-port y-parameters to z-parameters.
    #
    #   yxx - Dictionary that contains 2-port matrix of y-parameters,
    #    each matrix element is the list of values at different
    #    frequencies (or other parameter) in form of {real imag}.
    #    The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}
    #
    # Returns dictionary of the same form as input dictionary with z-parameters
    #
    ::rfutil::compLen $yxx
    set len [llength [dget $yxx 11]]
    set m1c [complex -1 0]
    set 2c [complex 2 0]
    for {set i 0} {$i&lt;$len} {incr i} {
        set 11 [@ [dget $yxx 11] $i]
        set 21 [@ [dget $yxx 21] $i]
        set 12 [@ [dget $yxx 12] $i]
        set 22 [@ [dget $yxx 22] $i]
        lappend z11 [/ $22 [- [* $11 $22] [* $12 $21]]]
        lappend z12 [/ [* $12 $m1c] [- [* $11 $22] [* $12 $21]]]
        lappend z21 [/ [* $21 $m1c] [- [* $11 $22] [* $12 $21]]]
        lappend z22 [/ $11 [- [* $11 $22] [* $12 $21]]]
    }
    return [dict create 11 $z11 21 $z21 12 $z12 22 $z22]
}</pre></div>
</div><h3 class='ruffproc'><a name='::rfutil::yPEq'>yPEq</a><span class='ns_scope'> [<a href="index-rfutil.html#::rfutil" title="::rfutil" class='ruff_cmd'>::rfutil</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Calculates equivalent P circuit elements values.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>yPEq</span> <span class='ruff_arg'>yxx</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>yxx</code></td><td>Dictionary that contains 2-port matrix of y-parameters, each matrix element is the list of values at different frequencies (or other parameter) in form of {real imag}. The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}</td></tr>
</table>
<h5 class='ruff'>Description</h5><pre class='ruff'>
                 Y3
                 ___
     o-----o----|___|----o-----o
     .     |             |     .
     .    .-.           .-.    .
  P1 .    | |           | |    . P2
     .  Y1| |         Y2| |    .
     .    '-'           '-'    .
    \./    |             |    \./
     o-----o-------------o-----o
</pre>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns dictionary of the form {y1 {list} y2 {list} y3 {list}} with impedances of equivalent elements</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_rfutil_yPEq' href="javascript:toggleSource('rfutil_yPEq')">Show source</a></p>
<div id='rfutil_yPEq' class='ruff_dyn_src'><pre>proc ::rfutil::yPEq {yxx} {

    # Calculates equivalent P circuit elements values.
    #
    #  yxx - Dictionary that contains 2-port matrix of y-parameters,
    #   each matrix element is the list of values at different
    #   frequencies (or other parameter) in form of {real imag}.
    #   The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}
    #
    # Returns dictionary of the form {y1 {list} y2 {list} y3 {list}} with impedances of equivalent elements
    #
    #                      Y3
    #                      ___
    #          o-----o----|___|----o-----o
    #          .     |             |     .
    #          .    .-.           .-.    .
    #       P1 .    | |           | |    . P2
    #          .  Y1| |         Y2| |    .
    #          .    '-'           '-'    .
    #         \./    |             |    \./
    #          o-----o-------------o-----o
    #
    ::rfutil::compLen $yxx
    set len [llength [dget $yxx 11]]
    set m1c [complex -1 0]
    for {set i 0} {$i&lt;$len} {incr i} {
        set 11 [@ [dget $yxx 11] $i]
        set 21 [@ [dget $yxx 21] $i]
        set 22 [@ [dget $yxx 22] $i]
        lappend y1 [+ $11 $21]
        lappend y2 [+ $22 $21]
        lappend y3 [* $m1c $21]
    }
    return [dict create y1 $y1 y2 $y2 y3 $y3]
}</pre></div>
</div><h3 class='ruffproc'><a name='::rfutil::z2s'>z2s</a><span class='ns_scope'> [<a href="index-rfutil.html#::rfutil" title="::rfutil" class='ruff_cmd'>::rfutil</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Converts 2-port z-parameters to s-parameters.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>z2s</span> <span class='ruff_arg'>zxx z0</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>zxx</code></td><td>Dictionary that contains 2-port matrix of z-parameters, each matrix element is the list of values at different frequencies (or other parameter) in form of {real imag}. The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}</td></tr>
<tr><td><code>z0</code></td><td>Reference impedance in form of {real imag}</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns dictionary of the same form as input dictionary with s-parameters</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_rfutil_z2s' href="javascript:toggleSource('rfutil_z2s')">Show source</a></p>
<div id='rfutil_z2s' class='ruff_dyn_src'><pre>proc ::rfutil::z2s {zxx z0} {

    # Converts 2-port z-parameters to s-parameters.
    #
    #  zxx - Dictionary that contains 2-port matrix of z-parameters,
    #   each matrix element is the list of values at different
    #   frequencies (or other parameter) in form of {real imag}.
    #   The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}
    #  z0 - Reference impedance in form of {real imag}
    #
    # Returns dictionary of the same form as input dictionary with s-parameters
    #
    ::rfutil::compLen $zxx
    set len [llength [dget $zxx 11]]
    set 1c [complex 1 0]
    set 2c [complex 2 0]
    for {set i 0} {$i&lt;$len} {incr i} {
        set 11 [@ [dget $zxx 11] $i]
        set 21 [@ [dget $zxx 21] $i]
        set 12 [@ [dget $zxx 12] $i]
        set 22 [@ [dget $zxx 22] $i]
        lappend s11 [/ [- [* [- $11 $z0] [+ $22 $z0]] [* $12 $21]] [- [* [+ $11 $z0] [+ $22 $z0]] [* $12 $21]]]
        lappend s12 [/ [* [* $2c $12] $z0] [- [* [+ $11 $z0] [+ $22 $z0]] [* $12 $21]]]
        lappend s21 [/ [* [* $2c $21] $z0] [- [* [+ $11 $z0] [+ $22 $z0]] [* $12 $21]]]
        lappend s22 [/ [- [* [+ $11 $z0] [- $22 $z0]] [* $12 $21]] [- [* [+ $11 $z0] [+ $22 $z0]] [* $12 $21]]]
    }
    return [dict create 11 $s11 21 $s21 12 $s12 22 $s22]
}</pre></div>
</div><h3 class='ruffproc'><a name='::rfutil::z2y'>z2y</a><span class='ns_scope'> [<a href="index-rfutil.html#::rfutil" title="::rfutil" class='ruff_cmd'>::rfutil</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Converts 2-port z-parameters to y-parameters.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>z2y</span> <span class='ruff_arg'>zxx</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>zxx</code></td><td>Dictionary that contains 2-port matrix of z-parameters, each matrix element is the list of values at different frequencies (or other parameter) in form of {real imag}. The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns dictionary of the same form as input dictionary with y-parameters</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_rfutil_z2y' href="javascript:toggleSource('rfutil_z2y')">Show source</a></p>
<div id='rfutil_z2y' class='ruff_dyn_src'><pre>proc ::rfutil::z2y {zxx} {

    # Converts 2-port z-parameters to y-parameters.
    #
    #   zxx - Dictionary that contains 2-port matrix of z-parameters,
    #    each matrix element is the list of values at different
    #    frequencies (or other parameter) in form of {real imag}.
    #    The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}
    #
    # Returns dictionary of the same form as input dictionary with y-parameters
    #
    ::rfutil::compLen $zxx
    set len [llength [dget $zxx 11]]
    set m1c [complex -1 0]
    set 2c [complex 2 0]
    for {set i 0} {$i&lt;$len} {incr i} {
        set 11 [@ [dget $zxx 11] $i]
        set 21 [@ [dget $zxx 21] $i]
        set 12 [@ [dget $zxx 12] $i]
        set 22 [@ [dget $zxx 22] $i]
        lappend y11 [/ $22 [- [* $11 $22] [* $12 $21]]]
        lappend y12 [/ [* $12 $m1c] [- [* $11 $22] [* $12 $21]]]
        lappend y21 [/ [* $21 $m1c] [- [* $11 $22] [* $12 $21]]]
        lappend y22 [/ $11 [- [* $11 $22] [* $12 $21]]]
    }
    return [dict create 11 $y11 21 $y21 12 $y12 22 $y22]
}</pre></div>
</div><h3 class='ruffproc'><a name='::rfutil::zTEq'>zTEq</a><span class='ns_scope'> [<a href="index-rfutil.html#::rfutil" title="::rfutil" class='ruff_cmd'>::rfutil</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Calculates equivalent T circuit elements values.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>zTEq</span> <span class='ruff_arg'>zxx</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>zxx</code></td><td>Dictionary that contains 2-port matrix of z-parameters, each matrix element is the list of values at different frequencies (or other parameter) in form of {real imag}. The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}</td></tr>
</table>
<h5 class='ruff'>Description</h5><pre class='ruff'>
          Z1            Z2
         ___           ___
    o---|___|----o----|___|---o
    .            |            .
    .           .-.           .
 P1 .           | |           . P2
    .         Z3| |           .
    .           '-'           .
   \./           |           \./
    o----------- o -----------o
</pre>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns dictionary of the form {z1 {list} z2 {list} z3 {list}} with impedances of equivalent elements</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_rfutil_zTEq' href="javascript:toggleSource('rfutil_zTEq')">Show source</a></p>
<div id='rfutil_zTEq' class='ruff_dyn_src'><pre>proc ::rfutil::zTEq {zxx} {

    # Calculates equivalent T circuit elements values.
    #
    #  zxx - Dictionary that contains 2-port matrix of z-parameters,
    #   each matrix element is the list of values at different
    #   frequencies (or other parameter) in form of {real imag}.
    #   The form of dictionary is: {11 {list} 12 {list} 21 {list} 22 {list}}
    #
    # Returns dictionary of the form {z1 {list} z2 {list} z3 {list}} with impedances of equivalent elements
    #
    #               Z1            Z2
    #              ___           ___
    #         o---|___|----o----|___|---o
    #         .            |            .
    #         .           .-.           .
    #      P1 .           | |           . P2
    #         .         Z3| |           .
    #         .           '-'           .
    #        \./           |           \./
    #         o----------- o -----------o
    #
    ::rfutil::compLen $zxx
    set len [llength [dget $zxx 11]]
    for {set i 0} {$i&lt;$len} {incr i} {
        set 11 [@ [dget $zxx 11] $i]
        set 21 [@ [dget $zxx 21] $i]
        set 22 [@ [dget $zxx 22] $i]
        lappend z1 [- $11 $21]
        lappend z2 [- $22 $21]
        lappend z3 $21
    }
    return [dict create z1 $z1 z2 $z2 z3 $z3]
}</pre></div>
</div></main><nav class='ruff-nav'><ul ><li class='ruff-toc1'><a style='padding-top:2px;' href='index.html'>Start page</a></li>
<li class='ruff-toc1'><a href='index-docindex.html' accesskey='i'>Index</a></li>
<hr>
<li class='ruff-toc1'><a href='index-gnuplotutil.html'>gnuplotutil</a></li>
<li class='ruff-toc1'><a href='index-mathutil.html'>mathutil</a></li>
<li class='ruff-toc1'><a class='ruff-highlight' href='index-rfutil.html'>rfutil</a></li>
<li class='ruff-toc1'><a href='index-touchstoneutil.html'>touchstoneutil</a></li>
<hr><li class='ruff-toc2'><a href='#::rfutil-Commands'>Commands</a></li><li class='ruff-toc3 ruff-tip'><a href='index-rfutil.html#::rfutil::angle'>angle</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>angle</span> <span class='ruff_arg'>data ?args?</span></pre>Calculates angle (phase) of complex number.
</span></li><li class='ruff-toc3 ruff-tip'><a href='index-rfutil.html#::rfutil::compLen'>compLen</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>compLen</span> <span class='ruff_arg'>dict</span></pre>Check the lengths of lists of each dictionary's list
</span></li><li class='ruff-toc3 ruff-tip'><a href='index-rfutil.html#::rfutil::cxxPEq'>cxxPEq</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>cxxPEq</span> <span class='ruff_arg'>freq yxx</span></pre>Calculates capacitive part equivalent P circuit elements values.
</span></li><li class='ruff-toc3 ruff-tip'><a href='index-rfutil.html#::rfutil::cxxTEq'>cxxTEq</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>cxxTEq</span> <span class='ruff_arg'>freq zxx</span></pre>Calculates capacitive part equivalent T circuit elements values.
</span></li><li class='ruff-toc3 ruff-tip'><a href='index-rfutil.html#::rfutil::deemb'>deemb</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>deemb</span> <span class='ruff_arg'>sMeas sFixtL sFixtR</span></pre>Procedure for deembedding of DUT from test fixture.
</span></li><li class='ruff-toc3 ruff-tip'><a href='index-rfutil.html#::rfutil::inv2x2'>inv2x2</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>inv2x2</span> <span class='ruff_arg'>mat</span></pre>Calculates inverse matrix of input matrix with size 2x2.
</span></li><li class='ruff-toc3 ruff-tip'><a href='index-rfutil.html#::rfutil::lxxPEq'>lxxPEq</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>lxxPEq</span> <span class='ruff_arg'>freq yxx</span></pre>Calculates inductive part equivalent P circuit elements values.
</span></li><li class='ruff-toc3 ruff-tip'><a href='index-rfutil.html#::rfutil::lxxTEq'>lxxTEq</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>lxxTEq</span> <span class='ruff_arg'>freq zxx</span></pre>Calculates inductive part equivalent T circuit elements values.
</span></li><li class='ruff-toc3 ruff-tip'><a href='index-rfutil.html#::rfutil::mag'>mag</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>mag</span> <span class='ruff_arg'>data ?args?</span></pre>Calculates magnitude of complex number.
</span></li><li class='ruff-toc3 ruff-tip'><a href='index-rfutil.html#::rfutil::matMul2x2'>matMul2x2</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>matMul2x2</span> <span class='ruff_arg'>mat1 mat2</span></pre>Calculates multiply matrices with 2x2 size.
</span></li><li class='ruff-toc3 ruff-tip'><a href='index-rfutil.html#::rfutil::s2t'>s2t</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>s2t</span> <span class='ruff_arg'>sxx</span></pre>Converts 2-port s-parameters to transfer parameters.
</span></li><li class='ruff-toc3 ruff-tip'><a href='index-rfutil.html#::rfutil::s2y'>s2y</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>s2y</span> <span class='ruff_arg'>sxx z0</span></pre>Converts 2-port s-parameters to y-parameters.
</span></li><li class='ruff-toc3 ruff-tip'><a href='index-rfutil.html#::rfutil::s2z'>s2z</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>s2z</span> <span class='ruff_arg'>sxx z0</span></pre>Converts 2-port s-parameters to z-parameters.
</span></li><li class='ruff-toc3 ruff-tip'><a href='index-rfutil.html#::rfutil::t2s'>t2s</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>t2s</span> <span class='ruff_arg'>txx</span></pre>Converts 2-port transfer parameters to s-parameters.
</span></li><li class='ruff-toc3 ruff-tip'><a href='index-rfutil.html#::rfutil::y2s'>y2s</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>y2s</span> <span class='ruff_arg'>yxx z0</span></pre>Converts 2-port y-parameters to s-parameters.
</span></li><li class='ruff-toc3 ruff-tip'><a href='index-rfutil.html#::rfutil::y2z'>y2z</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>y2z</span> <span class='ruff_arg'>yxx</span></pre>Converts 2-port y-parameters to z-parameters.
</span></li><li class='ruff-toc3 ruff-tip'><a href='index-rfutil.html#::rfutil::yPEq'>yPEq</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>yPEq</span> <span class='ruff_arg'>yxx</span></pre>Calculates equivalent P circuit elements values.
</span></li><li class='ruff-toc3 ruff-tip'><a href='index-rfutil.html#::rfutil::z2s'>z2s</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>z2s</span> <span class='ruff_arg'>zxx z0</span></pre>Converts 2-port z-parameters to s-parameters.
</span></li><li class='ruff-toc3 ruff-tip'><a href='index-rfutil.html#::rfutil::z2y'>z2y</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>z2y</span> <span class='ruff_arg'>zxx</span></pre>Converts 2-port z-parameters to y-parameters.
</span></li><li class='ruff-toc3 ruff-tip'><a href='index-rfutil.html#::rfutil::zTEq'>zTEq</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>zTEq</span> <span class='ruff_arg'>zxx</span></pre>Calculates equivalent T circuit elements values.
</span></li></ul></nav><footer class='ruff-layout-footer ruff-ft'><div style='float: right;'>Document generated by <a href='https://ruff.magicsplat.com'>Ruff!</a></div><div>&copy; George Yashin</div></footer>
</div></body></html>
