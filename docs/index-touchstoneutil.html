<!DOCTYPE html><html><head><meta charset="utf-8"/>
<title>Collection of Tcl tools</title>
<link rel='stylesheet' type='text/css' href='assets/ruff-min.css' />
<script type='text/javascript' src='assets/ruff-min.js'></script>
</head>
<body>
<div class='ruff-layout'>
<header class='ruff-layout-header ruff-hd'>
<a style='text-decoration:none;' href='index.html'>Collection of Tcl tools (v0.1)</a>


            <div id="ruffButtonBar">
            <button id="ruffNavMove" onclick="ruffMoveNavPane()"></button>
            <button id="ruffToggleTheme" onclick="ruffNextTheme()"></button>
            </div>
        </header><main class='ruff-layout-main ruff-bd'><h1 class='ruff'><a name='::touchstoneutil'></a>::touchstoneutil<span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h1>
<div style='clear:both;'></div>
<h2 class='ruff'><a name='::touchstoneutil-Commands'></a>Commands<span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h2>
<div style='clear:both;'></div>
<h3 class='ruffproc'><a name='::touchstoneutil::s2p_read'>s2p_read</a><span class='ns_scope'> [<a href="index-touchstoneutil.html#::touchstoneutil" title="::touchstoneutil" class='ruff_cmd'>::touchstoneutil</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<div class='ruff_synopsis'><span class='ruff_cmd'>s2p_read</span> <span class='ruff_arg'>filePath</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>filePath</code></td><td>Not documented.</td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_touchstoneutil_s2p_read' href="javascript:toggleSource('touchstoneutil_s2p_read')">Show source</a></p>
<div id='touchstoneutil_s2p_read' class='ruff_dyn_src'><pre>proc ::touchstoneutil::s2p_read {filePath} {

    variable degtorad
    set infile [open $filePath r]
    set i 0
    set format &quot;&quot;
    while { [gets $infile line] &gt;= 0 } {
        incr i
        if {[string match !* $line]} {
            continue
        } elseif {[string match #* $line]} {
            set paramList [textutil::split::splitx $line]
            foreach param $paramList {
                if {[string tolower $param] == &quot;ri&quot;} {
                    set format &quot;ri&quot;
                } elseif {[string tolower $param] == &quot;db&quot;} {
                    set format &quot;db&quot;
                } elseif {[string tolower $param] == &quot;ma&quot;} {
                    set format &quot;ma&quot;
                }
            }
        } else {
            set lineList [split $line &quot; &quot;]
            lappend freq [@ $lineList 0]
            lappend 11a [@ $lineList 1]
            lappend 11b [@ $lineList 2]
            lappend 21a [@ $lineList 3]
            lappend 21b [@ $lineList 4]
            lappend 12a [@ $lineList 5]
            lappend 12b [@ $lineList 6]
            lappend 22a [@ $lineList 7]
            lappend 22b [@ $lineList 8]
        }
    }
    set len [llength $freq]
    if {$format==&quot;ri&quot;} {
        for {set i 0} {$i&lt;$len} {incr i} {
            lappend 11 [complex [@ $11a $i] [@ $11b $i]]
            lappend 21 [complex [@ $21a $i] [@ $21b $i]]
            lappend 12 [complex [@ $12a $i] [@ $12b $i]]
            lappend 22 [complex [@ $22a $i] [@ $22b $i]]
        }
    } elseif {$format==&quot;db&quot;} {
        for {set i 0} {$i&lt;$len} {incr i} {
            set 1j [complex 0 1]
            set mag11 [= {10.0**([@ $11a $i]/20.0)}]
            set phRad11 [= {$degtorad*[@ $11b $i]}]
            set mag21 [= {10.0**([@ $21a $i]/20.0)}]
            set phRad21 [= {$degtorad*[@ $21b $i]}]
            set mag12 [= {10.0**([@ $12a $i]/20.0)}]
            set phRad12 [= {$degtorad*[@ $12b $i]}]
            set mag22 [= {10.0**([@ $22a $i]/20.0)}]
            set phRad22 [= {$degtorad*[@ $22b $i]}]
            lappend 11 [* [complex $mag11 0] [exp [* $1j [complex $phRad11 0]]]]
            lappend 21 [* [complex $mag21 0] [exp [* $1j [complex $phRad21 0]]]]
            lappend 12 [* [complex $mag12 0] [exp [* $1j [complex $phRad12 0]]]]
            lappend 22 [* [complex $mag22 0] [exp [* $1j [complex $phRad22 0]]]]
        }
    } elseif {$format==&quot;ma&quot;} {
        for {set i 0} {$i&lt;$len} {incr i} {
            set 1j [complex 0 1]
            set mag11 [@ $11a $i]
            set phRad11 [= {$degtorad*[@ $11b $i]}]
            set mag21 [@ $21a $i]
            set phRad21 [= {$degtorad*[@ $21b $i]}]
            set mag12 [@ $12a $i]
            set phRad12 [= {$degtorad*[@ $12b $i]}]
            set mag22 [@ $22a $i]
            set phRad22 [= {$degtorad*[@ $22b $i]}]
            lappend 11 [* [complex $mag11 0] [exp [* $1j [complex $phRad11 0]]]]
            lappend 21 [* [complex $mag21 0] [exp [* $1j [complex $phRad21 0]]]]
            lappend 12 [* [complex $mag12 0] [exp [* $1j [complex $phRad12 0]]]]
            lappend 22 [* [complex $mag22 0] [exp [* $1j [complex $phRad22 0]]]]
        }
    } else {
        error {Format of the file is not ri, db or ma}
    }
    return [dict create freq $freq 11 $11 21 $21 12 $12 22 $22]
}</pre></div>
</div></main><nav class='ruff-nav'><ul ><li class='ruff-toc1'><a style='padding-top:2px;' href='index.html'>Start page</a></li>
<li class='ruff-toc1'><a href='index-docindex.html' accesskey='i'>Index</a></li>
<hr>
<li class='ruff-toc1'><a href='index-gnuplotutil.html'>gnuplotutil</a></li>
<li class='ruff-toc1'><a href='index-mathutil.html'>mathutil</a></li>
<li class='ruff-toc1'><a href='index-rfutil.html'>rfutil</a></li>
<li class='ruff-toc1'><a class='ruff-highlight' href='index-touchstoneutil.html'>touchstoneutil</a></li>
<hr><li class='ruff-toc2'><a href='#::touchstoneutil-Commands'>Commands</a></li><li class='ruff-toc3 ruff-tip'><a href='index-touchstoneutil.html#::touchstoneutil::s2p_read'>s2p_read</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>s2p_read</span> <span class='ruff_arg'>filePath</span></pre></span></li></ul></nav><footer class='ruff-layout-footer ruff-ft'><div style='float: right;'>Document generated by <a href='https://ruff.magicsplat.com'>Ruff!</a></div><div>&copy; George Yashin</div></footer>
</div></body></html>
